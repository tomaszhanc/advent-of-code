#!/usr/bin/env php
<?php

require __DIR__ . '/../vendor/autoload.php';

use Advent\Shared\Command\Runner;
use Advent\Shared\Command\Runners;
use Advent\Year2023\Day1;
use Symfony\Component\Console\Command\Command;
use Symfony\Component\Console\Input\InputArgument;
use Symfony\Component\Console\Input\InputInterface;
use Symfony\Component\Console\Output\OutputInterface;
use Symfony\Component\Console\SingleCommandApplication;
use Symfony\Component\Console\Style\SymfonyStyle;

$runners = (new Runners())
    ->add(
        'Day 1',
        Runner::create([Day1::create(), 'partOne_sumAllCalibrationValues'], __DIR__ . '/../resources/day1.txt'),
        Runner::create([Day1::create(), 'partTwo_sumAllCalibrationValues'], __DIR__ . '/../resources/day1.txt')
    );

(new SingleCommandApplication())
    ->addArgument('day', InputArgument::OPTIONAL, 'Day to run')
    ->setCode(function (InputInterface $input, OutputInterface $output) use ($runners) : int {
        $io = new SymfonyStyle($input, $output);
        $io->title('Advent Of Code 2023');

        $runners->each();

        foreach ($runners as $day => $parts) {
            $io->section('Solution for: ' . $day);

            foreach ($parts as $index => $part) {
                $io->text(sprintf('Part %d: %s', $index+1, $part->bla()));
            }

            $io->newLine();
        }

        return Command::SUCCESS;
    })
    ->run();