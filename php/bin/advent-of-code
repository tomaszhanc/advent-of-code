#!/usr/bin/env php
<?php

require __DIR__ . '/../vendor/autoload.php';

use Advent\Year2023\Day1;
use Symfony\Component\Console\Command\Command;
use Symfony\Component\Console\Helper\QuestionHelper;
use Symfony\Component\Console\Input\InputArgument;
use Symfony\Component\Console\Input\InputInterface;
use Symfony\Component\Console\Output\OutputInterface;
use Symfony\Component\Console\Question\ChoiceQuestion;
use Symfony\Component\Console\SingleCommandApplication;
use Symfony\Component\Console\Style\SymfonyStyle;

(new SingleCommandApplication())
    ->addArgument('day', InputArgument::OPTIONAL, 'Day to run')
    ->setCode(function (InputInterface $input, OutputInterface $output): int {
        $io = new SymfonyStyle($input, $output);
        $io->title('Advent Of Code 2023');

        /** @var QuestionHelper $helper */
        $helper = $this->getHelper('question');
        $options = [
            1 => \str_pad('Day 01: Trebuchet?!', 50) . 'https://adventofcode.com/2023/day/1',
            2 => \str_pad('Day 02: Cube Conundrum', 50) . 'https://adventofcode.com/2023/day/2',
            3 => \str_pad('Day 03: Gear Ratios', 50) . 'https://adventofcode.com/2023/day/3',
        ];

        $day = $input->getArgument('day');
        $day = array_key_exists($day, $options) ? $day : null;

        if ($day === null) {
            $question = new ChoiceQuestion('Please select a day to run', $options);
            $answer = $helper->ask($input, $output, $question);
            $day = array_search($answer, $options);
        }

        $io->newLine();

        switch ($day) {
            case 1:
                $io->section('Solution for "Day 01: Trebuchet?!"');
                $io->text('Part One: ' . Day1::create()->partOne_sumAllCalibrationValues(__DIR__.'/../resources/day1.txt'));
                $io->text('Part Two: ' . Day1::create()->partTwo_sumAllCalibrationValues(__DIR__.'/../resources/day1.txt'));
                $io->newLine();
        }

        return Command::SUCCESS;
    })
    ->run();